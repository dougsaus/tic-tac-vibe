Please refer to the [Project Genesis](./docs/PROJECT_GENESIS.md) doc for a note from the Author (the only portion of this project, including the rest of this README, that was not generated by AI).

# React + Phaser 3 Tic-Tac-Toe Game

This project is a modern, web-based Tic-Tac-Toe game built with React, Phaser 3, TypeScript, and Webpack. It features a dynamic React-based setup screen, customizable player options, scoring, sound effects, and a clean, interactive gameplay experience with seamless React-Phaser integration.

The intended audience for this document is a developer new to the project who needs to understand the architecture, setup the development environment, and begin contributing.

## Features

-   **Interactive Game Board:** A classic 3x3 grid where players can place their symbols.
-   **Customizable Player Setup:**
    -   Players can enter their own names.
    -   Players can choose their game symbol from a list of emojis (e.g., 🐱, 🍕, 🚀).
    -   The system prevents both players from choosing the same symbol.
    -   Players can choose the color of the line that appears when they win.
-   **Turn-Based Gameplay:** The game manages player turns, clearly indicating whose turn it is.
-   **Win/Draw Detection:** The game automatically detects and announces if a player has won or if the game is a draw.
-   **Winning Line:** A colored line is drawn through the three winning symbols.
-   **Scoring System:** Persistent scores for each player's wins and the number of draws are tracked across rounds.
-   **Sound Effects:**
    -   Unique sound effects for different emoji symbols.
    -   Specific sounds for winning a round or a draw.
-   **New Round / New Game:**
    -   Players can start a "New Round" which resets the board but keeps the scores and players. The loser of the previous round starts the next one.
    -   Players can start a "New Game" which takes them back to the setup screen to re-configure players and resets the scores.

## Tech Stack

-   **Frontend Framework:** [React](https://react.dev/) with [TypeScript](https://www.typescriptlang.org/)
-   **Game Engine:** [Phaser 3](https://phaser.io/) (integrated with React)
-   **Bundler:** [Webpack](https://webpack.js.org/)
-   **Development Server:** [webpack-dev-server](https://webpack.js.org/configuration/dev-server/)
-   **Testing:** [Cypress](https://www.cypress.io/) for E2E testing
-   **Linting:** [ESLint](https://eslint.org/) with TypeScript support

## Project Structure

```
.
├── /assets/sounds/         # Sound effect files (.ogg, .mp3)
├── /cypress/               # E2E test files and configuration
│   ├── /e2e/               # Test specifications
│   └── cypress.config.ts   # Cypress configuration
├── /deploy/                # Deployment and infrastructure configuration
│   ├── nginx.conf          # NGINX configuration for buildpack deployment
│   └── project.toml        # Cloud Native Buildpack configuration
├── /dist/                  # Compiled output bundle (not in git)
├── /node_modules/          # Project dependencies (not in git)
├── /src/
│   ├── /components/        # React components
│   │   ├── App.tsx         # Main React application component
│   │   ├── GameScreen.tsx  # React wrapper for Phaser game
│   │   └── GameSetupScreen.tsx # React-based setup form
│   ├── /phaser/            # Phaser game engine code
│   │   └── game.ts         # Core Phaser game logic (GameScene)
│   ├── /services/          # Service modules
│   │   ├── ai-config-loader.ts # AI configuration and API integration
│   │   └── ai-player.ts    # AI player logic and move generation
│   ├── /types/             # TypeScript type definitions
│   │   └── game-types.ts   # Shared game interfaces and types
│   └── index.tsx           # React application entry point
├── /docs/                  # Project documentation
│   ├── BUILDPACK_CONFIG.md     # Cloud Native Buildpack configuration details
│   ├── buildpack-migration-plan.md # Complete migration plan and process
│   ├── DESIGN_PLAN.md          # Outlines the plan for UI/UX improvements
│   ├── PROJECT_GENESIS.md      # Author's note about project origins
│   ├── sessions.md             # Development session history
│   └── TESTING_PLAN.md         # Testing strategy and scenarios
├── /guidance/              # LLM context and guidance documents
│   └── frontend_testing_guidance.md # Testing guidance for AI assistants
├── index.html              # The main HTML entry point for React app
├── Makefile                # Build automation with buildpack support
├── package.json            # Project dependencies and scripts
├── package-lock.json       # Exact dependency versions
├── tsconfig.json           # TypeScript compiler configuration
└── webpack.config.js       # Webpack bundler configuration
```

## Getting Started

To get the project running locally, follow these steps.

### Prerequisites

-   [Node.js](https://nodejs.org/) and [npm](https://www.npmjs.com/) installed on your machine.

### Installation

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd <repository-directory>
    ```

2.  **Install dependencies:**
    Run the following command in the project root to install all necessary packages from `package.json`.
    ```bash
    npm install
    ```

### Running the Development Server

This project uses `webpack-dev-server` for a live-reloading development experience.

-   **Start the server:**
    ```bash
    npm start
    ```
-   This will automatically open the game in your default web browser at `http://localhost:8080`.
-   The server watches for changes in the source files (`.ts`, `.html`) and will automatically re-bundle and reload the page.

### Building for Production

To create a static bundle in the `/dist` directory, you can run the build script. This will lint the code and create an optimized webpack bundle.
```bash
npm run build
```

### Testing

The project includes comprehensive E2E tests using Cypress:

```bash
# Run tests in headless mode
npm run test:headless

# Open Cypress test runner for interactive testing
npm test
```

## Running with Docker

You can run the application inside a Docker container using Cloud Native Buildpacks or the traditional Dockerfile approach.

### Prerequisites

*   [Docker](https://www.docker.com/get-started) installed on your machine.
*   [Pack CLI](https://buildpacks.io/docs/tools/pack/) for buildpack builds (install with `brew install buildpacks/tap/pack` on macOS).

### Using Cloud Native Buildpacks (Recommended)

We provide a Makefile for easy container management with buildpacks:

```bash
# Build and run the container (default)
make

# Or explicitly:
make all

# Individual commands:
make build    # Build the container using buildpacks
make run      # Run the container on port 8080
make stop     # Stop and remove the container
make clean    # Clean up container and images
make dev      # Run development server locally
make test     # Run tests in headless mode
```

The buildpack approach automatically:
- Detects and installs Node.js dependencies
- Runs the webpack build
- Configures NGINX to serve the static files
- Creates a production-ready container

### Using Traditional Dockerfile

The original Dockerfile is still available for comparison:

```bash
./build-and-run.sh
```

This script will automatically handle stopping and removing any old containers with the same name. Your application will be available at `http://localhost:8080`.

## Troubleshooting

### Buildpack Issues

**Problem: Build fails with "unable to create manifests file" error**
- **Solution**: Disable containerd storage in Docker Desktop settings and restart Docker

**Problem: Platform warning about linux/amd64 vs linux/arm64**
- **Solution**: This is a warning only; the container will still run on Apple Silicon Macs using emulation
- **Future**: Multi-architecture support can be added to the buildpack configuration

**Problem: Container exits immediately after starting**
- **Solution**: Check logs with `docker logs tic-tac-vibe` - common issues include:
  - Missing nginx.conf file
  - Port conflicts on 8080
  - File permission issues

**Problem: Assets not loading (404 errors)**
- **Solution**: Ensure the nginx.conf file has correct paths for `/dist/` and `/assets/` directories

### Development Issues

**Problem: Changes not reflected after rebuilding**
- **Solution**: Run `make clean` before `make build` to ensure a fresh build
- **Alternative**: Use `make dev` for live-reloading during development

**Problem: Tests failing with "Cannot connect to localhost:8080"**
- **Solution**: Ensure no other services are using port 8080
- **Check**: Run `lsof -i :8080` to see what's using the port

### Performance Issues

**Problem: Build takes too long**
- **Solution**: Buildpack builds cache layers; subsequent builds should be faster
- **Tip**: Use `make dev` for development instead of rebuilding containers

For more details on buildpack configuration, see [BUILDPACK_CONFIG.md](./docs/BUILDPACK_CONFIG.md).

## How to Contribute

1.  Pick an unassigned task from the `docs/DESIGN_PLAN.md` or an open issue.
2.  Create a new branch for your feature or bug fix: `git checkout -b feature/my-new-feature`
3.  Make your changes.
4.  Test your changes thoroughly.
5.  Commit your changes with a clear and descriptive message.
6.  Push your branch and open a pull request.